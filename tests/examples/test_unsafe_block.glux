// 測試 unsafe 區塊功能

// 普通區塊中的正常運算
a := 10
b := -a
println(`a = ${a}, -a = ${b}`)

// 嘗試在普通區塊中使用位元運算（應該報錯）
// c := 5
// d := ~c  // 這會報錯，因為按位取反需要在 unsafe 區塊中

// unsafe 區塊中的位元運算
unsafe {
    // 按位取反操作
    c := 5  // 二進制: 101
    d := ~c  // 二進制: 11111111111111111111111111111010（取決於整數位寬）
    println(`c = ${c}, ~c = ${d}`)
    
    // 位移運算
    e := 8   // 二進制: 1000
    f := e << 2  // 二進制: 100000 (32)
    g := e >> 1  // 二進制: 100 (4)
    println(`${e} << 2 = ${f}`)
    println(`${e} >> 1 = ${g}`)
    
    // 位元運算
    h := 12  // 二進制: 1100
    i := 10  // 二進制: 1010
    j := h & i  // 二進制: 1000 (8)
    k := h | i  // 二進制: 1110 (14)
    l := h ^ i  // 二進制: 0110 (6)
    
    println(`${h} & ${i} = ${j}`)
    println(`${h} | ${i} = ${k}`)
    println(`${h} ^ ${i} = ${l}`)
}

// 確認離開 unsafe 區塊後，位元運算符不能使用
// m := 7
// n := m << 1  // 這會報錯，因為位移運算符需要在 unsafe 區塊中

println("測試完成"); 